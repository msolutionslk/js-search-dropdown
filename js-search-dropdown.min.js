function Jsd(e){const t=e.identifier,n=e.fetch,i=e.param??"q",a=$("#"+t).attr("name");let c,o=-1,r=0,s=-1;$(window).keydown((function(e){if(13==e.keyCode)return e.preventDefault(),!1})),$("#"+t).removeAttr("name");$('<input type="hidden" id="'+t+'-hidden" />'+'<div class="jsd-search-container" id="'+t+'-search"></div>').insertAfter("#"+t);const d=$("#"+t),l=$("#"+t).css("width"),u=document.createElement("ul");$("#"+t+"-search").css("width",l),$("#"+t+"-search").append(u),$(u).append('<li class="loader"></li>');let h=null;function f(e){if(r<e)return!1;const t=u.childNodes;for(inx in t)inx==e&&($(t[inx]).addClass("active"),s>-1&&$(t[s]).removeClass("active"),s=inx)}d.keyup((function(e){e.preventDefault();const c=e.keyCode;if(38===c||40===c||13===c){switch(c){case 38:return void(o>0&&f(--o));case 40:return void(o<r&&f(++o));case 13:return void function(e){if(r<e)return!1;const n=u.childNodes;for(inx in n)if(inx==e){const e=n[inx].innerHTML,i=$(n[inx]).attr("data-id");d.val(e),$("#"+t+"-hidden").prop("name",a).val(i),$("#"+t+"-search").hide()}}(o);default:return!1}return}clearTimeout(h),$("#"+t+"-search").show(),$(u).html('<li class="loader"></li>');h=setTimeout((function(){const c=e.target.value;(async function(e){return await fetch(e).then((e=>e.json()))})(n+"?"+i+"="+c).then((e=>{$(u).html(""),o=-1,s=-1,e.map((e=>{let n=document.createElement("li"),i=document.createAttribute("data-id");i.value=e.value,n.textContent=e.title,n.setAttributeNode(i),$(u).append(n),$(n).mouseover((function(){$(this).addClass("active")})).mouseout((function(){$(this).removeClass("active")})),$(n).click((function(){const e=$(this).attr("data-id");$("#"+t+"-hidden").prop("name",a).val(e);const n=$(this).html();d.val(n)}))})),r=u.childNodes.length-1}))}),1e3)})).blur((function(){c=setTimeout((function(){$("#"+t+"-search").hide(),clearTimeout(c)}),100)}))}
