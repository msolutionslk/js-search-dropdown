function Jsd(e){const t=e.identifier,n=e.fetch,i=e.param??"q",a=$("#"+t).attr("name");let c=-1,s=0,r=-1;$("#"+t).removeAttr("name");$('<input type="hidden" id="'+t+'-hidden" />'+'<div class="jsd-search-container" id="'+t+'-search"></div>').insertAfter("#"+t);const d=$("#"+t),o=$("#"+t).css("width"),l=document.createElement("ul");$("#"+t+"-search").css("width",o),$("#"+t+"-search").append(l),$(l).append('<li class="loader"></li>');let u=null;function h(e){if(s<e)return!1;const t=l.childNodes;for(inx in t)inx==e&&($(t[inx]).addClass("active"),r>-1&&$(t[r]).removeClass("active"),r=inx)}d.keyup((function(e){e.preventDefault();const o=e.keyCode;if(38===o||40===o||13===o){switch(o){case 38:return void(c>0&&h(--c));case 40:return void(c<s&&h(++c));case 13:return void function(e){if(s<e)return!1;const n=l.childNodes;for(inx in n)if(inx==e){const e=n[inx].innerHTML,i=$(n[inx]).attr("data-id");d.val(e),$("#"+t+"-hidden").val(i),$("#"+t+"-search").hide()}}(c);default:return!1}return}clearTimeout(u),$("#"+t+"-search").show(),$(l).html('<li class="loader"></li>');u=setTimeout((function(){const d=e.target.value;(async function(e){return await fetch(e).then((e=>e.json()))})(n+"?"+i+"="+d).then((e=>{$(l).html(""),c=-1,r=-1,e.map((e=>{let n=document.createElement("li"),i=document.createAttribute("data-id");i.value=e.value,n.textContent=e.title,n.setAttributeNode(i),$(l).append(n),$(n).mouseover((function(){$(this).addClass("active")})).mouseout((function(){$(this).removeClass("active")})),$(n).click((function(){const e=$(this).attr("data-id");$("#"+t+"-hidden").prop("name",a).val(e),$("#"+t+"-search").hide()}))})),s=l.childNodes.length-1}))}),1e3)})).blur((function(){$("#"+t+"-search").hide()}))}
